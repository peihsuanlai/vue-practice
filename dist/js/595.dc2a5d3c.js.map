{"version":3,"file":"js/595.dc2a5d3c.js","mappings":"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","sources":["webpack://vue-project/./src/views/CouponView.vue","webpack://vue-project/./src/components/CouponModal.vue","webpack://vue-project/./src/components/CouponModal.vue?3d2f","webpack://vue-project/./src/views/CouponView.vue?83d7"],"sourcesContent":["<template>\r\n    <LoadingView :active=\"isLoading\"></LoadingView>\r\n    <div>\r\n      <div class=\"text-end mt-4\">\r\n        <button class=\"btn btn-primary\" @click=\"openCouponModal(true)\">\r\n          建立新的優惠券\r\n        </button>\r\n      </div>\r\n      <table class=\"table mt-4\">\r\n        <thead>\r\n        <tr>\r\n          <th>名稱</th>\r\n          <th>折扣百分比</th>\r\n          <th>到期日</th>\r\n          <th>是否啟用</th>\r\n          <th>編輯</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr v-for=\"coupon in coupons\" :key=\"coupon.key\">\r\n          <td>{{coupon.title}}</td>\r\n          <td>{{coupon.percent}}</td>\r\n          <td>{{$filter.date(coupon.due_date)}}</td>\r\n          <td>\r\n            <span>啟用</span>\r\n            <span>未啟用</span>\r\n          </td>\r\n          <td>\r\n            <div class=\"btn-group\">\r\n              <button class=\"btn btn-outline-primary btn-sm\" @click=\"openCouponModal(false,coupon)\"\r\n              >編輯</button>\r\n              <button class=\"btn btn-outline-danger btn-sm\" @click=\"openDeleteModal(coupon)\"\r\n              >刪除</button>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <DelModal ref=\"delModal\" :item=\"tempCoupon\"  @del-item=\"deleteCoupon\"></DelModal>\r\n    <CouponModal ref=\"couponModal\" :coupon=\"tempCoupon\" :title=\"isNew\" @update-coupon=\"updateCoupon\"></CouponModal>\r\n  </template>\r\n<script>\r\nimport DelModal from '@/components/DelModal.vue'\r\nimport CouponModal from '@/components/CouponModal.vue'\r\nexport default {\r\n  data () {\r\n    return {\r\n      coupons: [],\r\n      pagination: {},\r\n      tempCoupon: {\r\n        title: '',\r\n        is_enabled: 0,\r\n        percent: 100,\r\n        code: ''\r\n      },\r\n      // 透過 props 傳到內層，內層透過 coupon 來接收\r\n      isNew: false,\r\n      isLoading: false\r\n    }\r\n  },\r\n  components: {\r\n    DelModal,\r\n    CouponModal\r\n  },\r\n  methods: {\r\n    getCoupons (page = 1) {\r\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`\r\n      this.isLoading = true // 正在取得資料，顯示 loading 狀態\r\n      // $http就是axios；使用axios調用post方法(api路徑,夾帶要送的資料)\r\n      this.$http.get(api).then((res) => {\r\n        console.log(res)\r\n        this.isLoading = false // 取得資料了，關閉 loading 狀態，要顯示資料了\r\n        this.coupons = res.data.coupons\r\n        this.pagination = res.data.pagination\r\n      })\r\n    },\r\n    openDeleteModal (coupon) {\r\n      const deletCoupon = this.$refs.delModal\r\n      this.tempCoupon = { ...coupon }\r\n      deletCoupon.showModal()\r\n    },\r\n    deleteCoupon (coupon) {\r\n      this.tempCoupon = coupon\r\n      this.isLoading = true\r\n      const delApi = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${coupon.id}`\r\n      this.$http.delete(delApi).then(() => {\r\n        this.isLoading = false\r\n        const deleCoupon = this.$refs.delModal\r\n        deleCoupon.hideModal()\r\n        this.getCoupons()\r\n      })\r\n    },\r\n    openCouponModal (isNew, coupon) {\r\n      if (isNew) {\r\n        this.tempCoupon = { due_date: new Date().getTime() / 1000 }\r\n      } else {\r\n        this.tempCoupon = { ...coupon }\r\n      }\r\n      this.isNew = isNew // 把帶入的參數儲存回 isNew\r\n      this.$refs.couponModal.showModal()\r\n    },\r\n    updateCoupon (coupon) {\r\n      console.log('test')\r\n      this.isLoading = true\r\n      this.tempCoupon = coupon\r\n      let api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`\r\n      let httpMethod = 'post'\r\n\r\n      // 如果不是新增優惠券>>>編輯\r\n      if (!this.isNew) {\r\n        api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${coupon.id}`\r\n        httpMethod = 'put'\r\n      }\r\n      const couponComponent = this.$refs.couponModal\r\n      // Bracket Notation 也就是 Object['attribute']，而中括號可以代入變數，它會自動轉成字串 mapping 到物件相應的屬性\r\n      this.$http[httpMethod](api, { data: this.tempCoupon }).then(\r\n        (response) => {\r\n          this.isLoading = false\r\n          console.log(response)\r\n          couponComponent.hideModal() // 關閉 modal\r\n          if (response.data.success) {\r\n            this.getCoupons() // 重新取得列表資料\r\n          }\r\n          this.$httpMessageState(response, '更新優惠券')\r\n        }\r\n      )\r\n    }\r\n\r\n  },\r\n  created () {\r\n    this.getCoupons()\r\n  }\r\n}\r\n</script>\r\n","<template>\r\n    <div class=\"modal fade\" id=\"couponModal\" tabindex=\"-1\" role=\"dialog\"\r\n         aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\" ref=\"modal\">\r\n      <div class=\"modal-dialog\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">{{ title ? \"新增優惠券\" : \"編輯優惠券\" }}</h5>\r\n            <button type=\"button\" class=\"btn-close\"\r\n                    data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"mb-3\">\r\n              <label for=\"title\">標題</label>\r\n              <input type=\"text\" class=\"form-control\" id=\"title\"\r\n                     placeholder=\"請輸入標題\" v-model=\"tempCoupon.title\">\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"coupon_code\">優惠碼</label>\r\n              <input type=\"text\" class=\"form-control\" id=\"coupon_code\"\r\n                     placeholder=\"請輸入優惠碼\" v-model=\"tempCoupon.code\">\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"due_date\">到期日</label>\r\n              <input type=\"date\" class=\"form-control\" id=\"due_date\" v-model=\"tempCoupon.due_date\">\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <label for=\"price\">折扣百分比</label>\r\n              <input type=\"number\" class=\"form-control\" id=\"price\" placeholder=\"請輸入折扣百分比\" v-model=\"tempCoupon.percent\">\r\n            </div>\r\n            <div class=\"mb-3\">\r\n              <div class=\"form-check\">\r\n                <input class=\"form-check-input\" type=\"checkbox\"\r\n                       :true-value=\"1\"\r\n                       :false-value=\"0\"\r\n                       id=\"is_enabled\"\r\n                       v-model=\"tempCoupon.is_enabled\">\r\n                <label class=\"form-check-label\" for=\"is_enabled\">\r\n                  是否啟用\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"$emit('update-coupon', tempCoupon)\">{{ title ? \"新增優惠券\" : \"編輯優惠券\" }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </template>\r\n<script>\r\nimport modalMixin from '@/mixins/modalMixin'\r\nexport default {\r\n  props: {\r\n    // 外層 tempCoupon 傳進來的資料透過 props coupon 接收\r\n    coupon: {\r\n      // 預期傳進來是物件型別\r\n      type: Object,\r\n      // 如果沒有正確傳入，則給予預設值\r\n      default () {\r\n        return {}\r\n      }\r\n    },\r\n    title: {\r\n      type: Boolean\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      modal: {},\r\n      // 作為外層資料的接收\r\n      tempCoupon: {},\r\n      due_date: ''\r\n    }\r\n  },\r\n  emits: ['update-coupon'],\r\n  watch: {\r\n    coupon () {\r\n      this.tempCoupon = this.coupon\r\n      // 將時間格式改為 YYYY-MM-DD\r\n      console.log(this.tempCoupon.due_date)\r\n      // const dateAndTime = new Date(this.tempCoupon.due_date * 1000).toISOString().split('T')\r\n      // [this.due_date] = dateAndTime\r\n    },\r\n    due_date () {\r\n      this.tempCoupon.due_date = Math.floor(new Date(this.due_date) / 1000)\r\n    }\r\n  },\r\n  mixins: [modalMixin]\r\n}\r\n\r\n</script>\r\n","import { render } from \"./CouponModal.vue?vue&type=template&id=5360aa67\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./CouponView.vue?vue&type=template&id=7d2f218c\"\nimport script from \"./CouponView.vue?vue&type=script&lang=js\"\nexport * from \"./CouponView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createVNode","_component_LoadingView","active","$data","isLoading","_hoisted_1","onClick","_cache","$event","$options","openCouponModal","_hoisted_2","_hoisted_3","_createElementBlock","_Fragment","_renderList","coupons","coupon","key","_toDisplayString","title","percent","_ctx","$filter","date","due_date","_hoisted_4","_hoisted_5","_hoisted_6","openDeleteModal","_hoisted_7","_component_DelModal","ref","item","tempCoupon","onDelItem","deleteCoupon","_component_CouponModal","isNew","onUpdateCoupon","updateCoupon","id","tabindex","role","type","for","$props","_hoisted_8","_hoisted_9","placeholder","_hoisted_10","_hoisted_11","code","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","is_enabled","_hoisted_18","_hoisted_19","_hoisted_20","$emit","props","Object","default","Boolean","data","modal","emits","watch","this","console","log","Math","floor","Date","mixins","modalMixin","__exports__","pagination","components","DelModal","CouponModal","methods","getCoupons","page","api","$http","get","then","res","deletCoupon","$refs","delModal","showModal","delApi","delete","deleCoupon","hideModal","getTime","couponModal","httpMethod","couponComponent","response","success","$httpMessageState","created","render"],"sourceRoot":""}